---
id: custom-view-graphql
title: graphql
---
Bappo sdk provide a graphql endpoint to query and modify data.
<AUTOGENERATED_TABLE_OF_CONTENTS>

---
## API

### gql

The gql is a template literal tag. Template literals were introduced in recent versions of ECMAScript to provide embedded expressions (i.e. `A string with interpolated ${variables}`) and template literal tags exist to provide additional functionality for what would otherwise be a normal template literal.

In the case of GraphQL, the gql tag is used to surround GraphQL operation and schema language (which are represented as Strings), and makes it easier to differentiate from ordinary strings. This is particularly useful when performing static analysis on GraphQL language (e.g. to enable syntax highlighting, code generation, etc.) and avoids need for tools to "guess" if a string contains GraphQL language.

Examples:
```javascript
import { gql } from "@bappo/sdk";
const GET_CUSTOMERS = gql`
  query Customers {
    Customer_all {
      id
      name
    }
  }
`;
```

### useQuery

The `useQuery` is the API for executing queries in your custom view. To run a query, call `useQuery` and pass it a GraphQL query string.
When your component renders, `useQuery` returns an object that contains loading, error, and data properties you can use to render your UI.

Example:
```javascript
import { useQuery, gql } from "@bappo/sdk";
const GET_CUSTOMERS = gql`
  query Customer($id: String!) {
    Customer (id: $id) {
        id
        name
    }
  }
`;

function Hello() {
const { loading, error, data } = useQuery(GET_CUSTOMERS, {
    variables: { id: 'edd1bfbf5e90375' },
  });
  if (loading) return <p>Loading ...</p>;
  if(error) return <p>Error</p>
  return <h1>Hello {data.customer.name}!</h1>;
}
```

#### Function Signature
```javascript
function useQuery<TData = any, TVariables = OperationVariables>(
  query: DocumentNode,
  options?: QueryOptions<TData, TVariables>,
): QueryResult<TData> {}
```
#### Params
**query**
|     Param     |     Type      |                    Description                   |
| :-----------: | :-----------: | :----------------------------------------------: |
|    `query`    |  DocumentNode |  A GraphQL query document parsed into an AST     |

**options**
|       Param      |           Type          |                                Description                                 |
| :--------------: | :---------------------: | :------------------------------------------------------------------------: |
|    `variables`   |  { [key: string]: any } |  An object containing all of the variables your query needs to execute     |


### useMutation
The `useMutation` is the API for executing mutations in your custom view. To run a mutations, call `mutations` and pass it a GraphQL  string that represents the mutation.
When your component renders, `useQuery` returns a tuple that includes:

- A mutate function that you can call at any time to execute the mutation
- An object with fields that represent the current status of the mutation's execution

Example:
```javascript
import { useMutation, gql } from "@bappo/sdk";
const GET_CUSTOMERS = gql`
  query Customers {
    Customer_all {
      id
      name
    }
  }
`;
const GET_CUSTOMERS_2 = gql`
  query activeCustomers {
    Customer_all(where: {
      active: true
    }) {
      id
      name
    }
  }
`;
const CREATE_CUSTOMER = gql`
  mutation createCustomer($name: String!) {
    createCustomer(input: { name: $name }) {
      id
      name
    }
  }
`;
export default function List() {
  const [createCustomer, result] = useMutation(CREATE_CUSTOMER, {
    variables: {
      name: "default name" // will be overridden
    },
    updateConfigs: [
      {
        type: "create",
        updateQuery: GET_CUSTOMERS,
        behaviour: "append"
      }
    ],
    refetchQueries: [GET_CUSTOMERS_2]
  });
  const { loading, error } = result;
  return (
    <div>
      <button
        onClick={() =>
          createCustomer({
            variables: {
              name: "qweqwe"
            }
          })
        }
      >
        Create a Customer
      </button>
      {loading && <div>mutation loading...</div>}
      {error && <div>mutation failed</div>}
    </div>
  );
}
```

#### Function Signature
```javascript
function useMutation<TData = any, TVariables = OperationVariables>(
  mutation: DocumentNode,
  options?: MutationOptions<TData, TVariables>,
): MutationTuple<TData, TVariables> {}
```
#### Params
**mutation**
|     Param     |     Type      |                    Description                   |
| :-----------: | :-----------: | :----------------------------------------------: |
|    `mutation`    |  DocumentNode |  A GraphQL query document parsed into an AST     |

**options**
|       Param      |           Type          |                                Description                                 |
| :-----------------------: | :------------------------------------------------------------------: | :------------------------------------------------------------------------------------: |
|    `variables`            |  { [key: string]: any }                                              |  An object containing all of the variables your query needs to execute     |
|    `updateConfigs`        |  (cache: ApolloCache<T>, mutationResult: <br>FetchResult<T>) => void |  A function used to update the cache after a mutation occurs     |
|    `optimisticResponse`   |  Object                                                              |  Provide a mutation response before the result comes back from the server     |
|    `refetchQueries`       |  `Array<any>`                                                        |  An array or function that allows you to specify which queries you want to refetch after a mutation has occurred     |
|    `awaitRefetchQueries`  |           boolean                                                    |  An object containing all of the variables your query needs to execute     |


## Gql syntax

### Find all records
#### Query Syntax
**{objectName}_all()**

#### Example:
```javascript
const GET_ALL_CUSTOMERS = gql`
  query Customer {
    Customer_all{
        id
        name
    }
  }
`;
```

### Insert a single object
#### Mutation Syntax
**create{objectName} ($input: { [key: fieldName]: fieldValue })**

#### Example:
```javascript
const CREATE_CUSTOMER = gql`
  mutation createCustomer($name: String!) {
    createCustomer(input: { name: $name }) {
      id
      name
    }
  }
`;
```

### Find all with sorting
Query results can be sorted by using the order argument.
The sort order (ascending vs. descending) is set by specifying the `ASC` or `DESC` enum value for the column name in the order input object, e.g. {name: ASC}.

#### Query Input Syntax
**{objectName}_all ($order: { [key: objectName]: OrderDirection }[] )**

#### Example:
```javascript
const GET_ALL_CUSTOMERS_IN_ORDER = gql`
  query Customer {
    Customer_all(order: [{ name: "ASC" }, { age: "ASC" }]){
        id
        name
    }
  }
`;
```